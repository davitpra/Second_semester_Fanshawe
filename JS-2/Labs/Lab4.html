<html>
  <head>
    <title>Lab 4- David Prado</title>
    <script language="JavaScript" type="text/JavaScript">

      let timers = [];

      let log = (function (outputFunc) {
        let counter = 0;
        let callerLog = [];
        let dateTime = [];

        // return inner anonymous function
        return function(caller) {

         // if counter is less than 11
         if (counter < 11) {
      	   // increment counter and push caller and date/time to arrays
           counter++;
           callerLog.push(caller);
           dateTime.push(new Date());

      	   // output the counter, caller, and date/time
           let outputString = counter + " " + caller + " " + dateTime[counter - 1];
           outputFunc(outputString);

         // if counter is 11
         } else {
      	   // output a line break and a message
           outputFunc("<br>");
           outputFunc("Logging stopped.");

      	   // clear all timers
           for (let i = 0; i < timers.length; i++) {
           	clearInterval(timers[i]);
           }
         }
        }
      })(printFunc); //IIFE (Immediately Invoked Function Expression), printFunc is the outputFunc parameter

      function printFunc(output) {
      	document.write(output + "<br>");
      }

      function startMeUp() {
      	// add each of the timer references to the timers array
      	// as part of invoking the log function following each interval
      	timers.push(setInterval("log('Timer1')", 1000));
      	timers.push(setInterval("log('Timer2')", 1200));
      	timers.push(setInterval("log('Timer3')", 1700));
      }
    </script>
  </head>
  <body onload="startMeUp();"></body>
</html>
